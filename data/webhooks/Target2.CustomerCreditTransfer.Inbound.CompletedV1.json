{
  "$schema": "http://json-schema.org/draft-04/schema#",
  "title": "Target2CustomerCreditTransferInboundCompletedWebHook",
  "type": "object",
  "additionalProperties": false,
  "required": [
	"PaymentId",
	"InstructionId",
	"EndToEndId",
	"Uetr",
	"SettlementAmount",
	"TransactionId"
  ],
  "properties": {
	"PaymentId": {
	  "title": "Payment ID",
      "type": "string",
      "pattern": "[a-zA-Z0-9_-]{0,50}",
      "description": "ClearBank internal identifier for this payment."
    },
	"InstructionId": {
      "title": "Customer internal identifier",
      "type": "string",
      "Pattern": "[0-9a-zA-Z\/\\-\\?:\\(\\)\\.,'\\+](|[0-9a-zA-Z\/\\-\\?:\\(\\)\\.,'\\+]|[0-9a-zA-Z\/\\-\\?:\\(\\)\\.,'\\+ ]{1,33}[0-9a-zA-Z\/\\-\\?:\\(\\)\\.,'\\+])",
      "description": "Unique identification, as assigned by an instructing party for an instructed party, to unambiguously identify the instruction."
    },
	"EndToEndId": {
      "title": "End to end ID",
      "type": "string",
      "pattern": "[0-9a-zA-Z\/\\-\\?:\\(\\)\\.,'\\+](|[0-9a-zA-Z\/\\-\\?:\\(\\)\\.,'\\+]|[0-9a-zA-Z\/\\-\\?:\\(\\)\\.,'\\+ ]{1,33}[0-9a-zA-Z\/\\-\\?:\\(\\)\\.,'\\+])",
      "description": "Unique identifier provided to ClearBank for each payment."
    },
    "Uetr": {
      "title": "Unique end-to-end reference",
      "type": "string",
      "format": "guid",
      "pattern": "[a-f0-9]{8}-[a-f0-9]{4}-4[a-f0-9]{3}-[89ab][a-f0-9]{3}-[a-f0-9]{12}",
      "description": "Universally unique UUID v4 identifier randomly generated to provide an end-to-end reference of a payment transaction."
    },
    "TransactionId": {
      "title": "Transaction ID",
      "type": "string",
      "format": "guid",
      "pattern": "[a-f0-9]{8}-[a-f0-9]{4}-4[a-f0-9]{3}-[89ab][a-f0-9]{3}-[a-f0-9]{12}",
      "description": "ID of the transaction used to move funds for this payment."
    },
    "SettlementAmount": {
      "oneOf": [
        {
          "$ref": "#/definitions/SettlementAmount"
        }
      ]
    },
    "Debtor": {
      "oneOf": [
          {"type": "null"},
          {"$ref": "#/definitions/PartyId"}      
      ]
    },
    "DebtorAccount": {
      "oneOf": [
          {"type": "null"},
          {"$ref": "#/definitions/Account"}
      ]
    },
    "DebtorAgent": {
      "oneOf": [
          {"type": "null"},
          {"$ref": "#/definitions/FinancialInstitutionId"}
      ]
    },
    "DebtorAgentAccount": {
      "oneOf": [
          {"type": "null"},
          {"$ref": "#/definitions/Account"}
      ]
    },
    "UltimateDebtor": {
      "oneOf": [
          {"type": "null"},
          {"$ref": "#/definitions/PartyId"}
      ]
    },
    "InitiatingParty": {
      "oneOf": [
          {"type": "null"},
          {"$ref": "#/definitions/PartyId"}
      ]
    },
    "Creditor": {
      "oneOf": [
          {"type": "null"},
          {"$ref": "#/definitions/PartyId"}
      ]
    },
    "CreditorAccount": {
      "oneOf": [
          {"type": "null"},
          {"$ref": "#/definitions/Account"}
      ]
    },
    "CreditorAgent": {
      "oneOf": [
          {"type": "null"},
          {"$ref": "#/definitions/FinancialInstitutionId"}
      ]
    },
    "CreditorAgentAccount": {
      "oneOf": [
          {"type": "null"},
          {"$ref": "#/definitions/Account"}
      ]
    },
    "UltimateCreditor": {
      "oneOf": [
          {"type": "null"},
          {"$ref": "#/definitions/PartyId"}
      ]
    },
    "PreviousInstructingAgents": {
      "title": "Previous instructing agents",
      "type": [
        "array", 
        "null"
      ],
      "maxItems": 3,
      "items": [
        {
          "$ref": "#/definitions/PreviousInstructingAgent"
        }
      ]    
    },
    "IntermediaryAgents": {
      "title": "Intermediary agents",
      "type": [
        "array", 
        "null"
      ],
      "maxItems": 3,
      "items": [
        {
          "$ref": "#/definitions/IntermediaryAgent"  
        }
      ]    
    }
  },
  "definitions": {
    "PreviousInstructingAgent": {
      "type": "object",
      "properties": {
        "type": {"$ref": "#/definitions/FinancialInstitutionId"},
        "type": {"$ref": "#/definitions/Account"} 
      }
    },
    "IntermediaryAgent": {
      "type": "object",
      "properties": {
        "type": {"$ref": "#/definitions/FinancialInstitutionId"},
        "type": {"$ref": "#/definitions/Account"} 
      }
    },
    "SettlementAmount": {
      "type": "object",
      "required": ["Amount", "Currency"],
      "additionalProperties": true,
      "properties": {
        "Amount": {
          "title": "Amount",
          "type": "number",
          "description": "Settlement payment amount.",
          "format": "decimal"
        },
        "Currency": {
          "title": "Currency",
          "type": "string",
          "description": "Currency of the settlement amount.",
          "pattern": "[A-Z]{3,3}"
        }
      }    
    },
    "PartyId": {
      "type": ["object", "null"],
      "additionalProperties": true,
      "properties": {
        "Name": {
          "title": "name",
          "type": ["string", "null"],
          "description": "Name by which a party is known and which is usually used to identify that party.",
          "maxLength": 140,
          "minLength": 1
        },
        "Bic": {
          "title": "BIC",
          "type": ["string", "null"],
          "pattern": "[A-Z0-9]{4,4}[A-Z]{2,2}[A-Z0-9]{2,2}[A-Z0-9]{3,3}",
          "description": "Business identifier code of the organisation."
        },
        "Address":{
          "oneOf": [
            {
              "$ref": "#/definitions/Address"
            }
          ]      
        }
      }    
    },
    "FinancialInstitutionId": {
      "type": ["object","null"],
      "additionalProperties": true,
      "properties": {
        "Name": {
          "title": "name",
          "type": ["string", "null"],
          "description": "Name by which the financial institution is known and which is usually used to identify that party.",
          "maxLength": 140,
          "minLength": 1
        },
        "BicFI": {
          "title": "BIC",
          "type": ["string", "null"],
          "pattern": "[A-Z0-9]{4,4}[A-Z]{2,2}[A-Z0-9]{2,2}[A-Z0-9]{3,3}",
          "description": "Business identifier code of the organisation."
        },
        "Address":{
          "oneOf": [
            {
              "$ref": "#/definitions/Address"
            }
          ]      
        }
      }    
    },
    "Address": {
      "type": ["object","null"],
      "additionalProperties": true,
      "TownName": {
        "title": "Town name",
        "type": ["string", "null"],
        "description": "Name of a built-up area, with defined boundaries, and a local government.",
        "pattern": "[0-9a-zA-Z\/\\-\\?:\\(\\)\\.,'\\+!#$%&\\*=^_`\\{\\|\\}~\";<>@\\[\\\\\\]](|[0-9a-zA-Z\/\\-\\?:\\(\\)\\.,'\\+!#$%&\\*=^_`\\{\\|\\}~\";<>@\\[\\\\\\]]|[0-9a-zA-Z\/\\-\\?:\\(\\)\\.,'\\+ !#$%&\\*=^_`\\{\\|\\}~\";<>@\\[\\\\\\]]{1,33}[0-9a-zA-Z\/\\-\\?:\\(\\)\\.,'\\+!#$%&\\*=^_`\\{\\|\\}~\";<>@\\[\\\\\\]])",
        "maxLength": 35,
        "minLength": 1
      },
      "Country": {
        "title": "Country",
        "type": ["string", "null"],
        "pattern": "[A-Z]{2,2}",
        "description": "Nation with its own government."
      },
      "AddressLines": {
        "title": "Address lines",
        "type": ["array","null"],
        "maxItems": 3,
        "items": {
          "$ref": "#/definitions/AddressLine"  
        }
      }
    },
    "AddressLine": {
      "type": ["string", "null"],
      "maxLength": 35,
      "minLength": 1       
    },
    "Account": {
      "type": ["object", "null"],
      "additionalProperties": true,
      "properties": {
        "Iban": {
          "title" : "IBAN",
          "type": ["string", "null"],
          "description": "International Bank Account Number associated with the party",
          "pattern": "[A-Z]{2,2}[0-9]{2,2}[a-zA-Z0-9]{1,30}"
        }  
      }
    }
  }
}